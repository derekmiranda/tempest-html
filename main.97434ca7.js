parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"TpxW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.matrix=void 0,exports.matrix={projection:function(t,r){return[2/t,0,0,0,-2/r,0,-1,1,1]},identity:function(){return[1,0,0,0,1,0,0,0,1]},translation:function(t,r){return[1,0,0,0,1,0,t,r,1]},rotation:function(t){var r=Math.cos(t),n=Math.sin(t);return[r,-n,0,n,r,0,0,0,1]},scaling:function(t,r){return[t,0,0,0,r,0,0,0,1]},multiply:function(t,r){var n=t[0],i=t[1],e=t[2],o=t[3],u=t[4],a=t[5],s=t[6],c=t[7],l=t[8],x=r[0],p=r[1],f=r[2],m=r[3],y=r[4],v=r[5],d=r[6],M=r[7],g=r[8];t[0]=x*n+p*o+f*s,t[1]=x*i+p*u+f*c,t[2]=x*e+p*a+f*l,t[3]=m*n+y*o+v*s,t[4]=m*i+y*u+v*c,t[5]=m*e+y*a+v*l,t[6]=d*n+M*o+g*s,t[7]=d*i+M*u+g*c,t[8]=d*e+M*a+g*l},cloneMultiply:function(t,r){var n=t[0],i=t[1],e=t[2],o=t[3],u=t[4],a=t[5],s=t[6],c=t[7],l=t[8],x=r[0],p=r[1],f=r[2],m=r[3],y=r[4],v=r[5],d=r[6],M=r[7],g=r[8];return[x*n+p*o+f*s,x*i+p*u+f*c,x*e+p*a+f*l,m*n+y*o+v*s,m*i+y*u+v*c,m*e+y*a+v*l,d*n+M*o+g*s,d*i+M*u+g*c,d*e+M*a+g*l]},translate:function(t,r,n){return exports.matrix.multiply(t,exports.matrix.translation(r,n))},rotate:function(t,r){return exports.matrix.multiply(t,exports.matrix.rotation(r))},scale:function(t,r,n){return exports.matrix.multiply(t,exports.matrix.scaling(r,n))},transformPoint:function(t,r,n){return{x:t[0]*r+t[3]*n+t[6],y:t[1]*r+t[4]*n+t[7]}},deriveAngle:function(t){return Math.asin(t[3])}};
},{}],"ehtn":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MAX_ID=exports.BULLET_TOLERANCE=exports.BULLET_SPEED=exports.RED_ENEMY_SPEED=exports.COLORS=exports.COLLISION_TOLERANCE=exports.ENEMY_TO_LEVEL_SIZE=exports.PLAYER_TO_LEVEL_SIZE=exports.PLAYER_TO_LEVEL_DIST=exports.FAR_SCALE=exports.LEVEL_CENTER=exports.AVG_FRAME_TIME=void 0,exports.AVG_FRAME_TIME=1/60,exports.LEVEL_CENTER={x:0,y:.1},exports.FAR_SCALE=.1,exports.PLAYER_TO_LEVEL_DIST=0,exports.PLAYER_TO_LEVEL_SIZE=.2,exports.ENEMY_TO_LEVEL_SIZE=.2,exports.COLLISION_TOLERANCE=.03,exports.COLORS={BG:"black",PLAYER:"yellow",BULLET:"pink",RED:"tomato",LINE:"blue"},exports.RED_ENEMY_SPEED=15e-5,exports.BULLET_SPEED=.003,exports.BULLET_TOLERANCE=1500*exports.BULLET_SPEED*exports.AVG_FRAME_TIME,exports.MAX_ID=Number.MAX_SAFE_INTEGER;
},{}],"BtqO":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Transform=void 0;var t=require("../CONSTS"),i=require("../lib/matrix"),s=function(){function s(t){var s=void 0===t?{}:t,r=s.x,a=void 0===r?0:r,h=s.y,o=void 0===h?0:h,e=s.z,n=void 0===e?0:e,x=s.w,m=void 0===x?1:x,d=s.h,p=void 0===d?1:d,v=s.angle,l=void 0===v?0:v;this.matrix=i.matrix.identity(),this.angle=0,this.setTransformWithProps({x:a,y:o,z:n,w:m,h:p,angle:l})}return s.prototype.getMatrix=function(){return this.matrix},s.prototype.setMatrix=function(t,i){void 0===i&&(i=!1),this.matrix=t,i&&this.updateTransformProps()},s.prototype.setTransformWithProps=function(s){var r=s.x,a=s.y,h=s.w,o=s.z,e=s.h,n=s.angle,x=i.matrix.identity();void 0!==r&&(this.x=r),void 0!==a&&(this.y=a),i.matrix.translate(x,this.x,this.y),void 0!==o&&(this.z=o),void 0!==n&&(this.angle=n),this.angle>=2*Math.PI&&(this.angle=this.angle/(2*Math.PI)%1),i.matrix.rotate(x,this.angle);var m=1-(1-t.FAR_SCALE)*this.z;void 0!==h&&(this.w=h),void 0!==e&&(this.h=e),i.matrix.scale(x,this.w*m,this.h*m),this.matrix=x},s.prototype.getTransformProps=function(){return{x:this.x,y:this.y,z:this.z,w:this.w,h:this.h,angle:this.angle}},s.prototype.updateWithProps=function(s){var r=s.x,a=s.y,h=s.w,o=s.z,e=s.h,n=s.angle;if((r||a)&&(void 0!==r&&(this.x+=r),void 0!==a&&(this.y+=a),i.matrix.translate(this.matrix,this.x,this.y)),void 0!==n&&(this.angle+=n,this.angle>=2*Math.PI&&(this.angle=this.angle/(2*Math.PI)%1),i.matrix.rotate(this.matrix,n)),void 0!==o&&(this.z+=o),h||e){void 0!==h&&(this.w*=h),void 0!==e&&(this.h*=e);var x=1-(1-t.FAR_SCALE)*this.z;i.matrix.scale(this.matrix,this.w*x,this.h*x)}},s.prototype.updateWithMatrix=function(t,s){void 0===s&&(s=!1),i.matrix.multiply(this.matrix,t),s&&this.updateTransformProps()},s.prototype.updateTransformProps=function(){this.x=this.matrix[6],this.y=this.matrix[7],this.angle=i.matrix.deriveAngle(this.matrix);var t=Math.cos(this.angle);this.w=this.matrix[0]/t,this.h=this.matrix[4]/t},s}();exports.Transform=s;
},{"../CONSTS":"ehtn","../lib/matrix":"TpxW"}],"f4jx":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseGameObject=void 0;var t=require("../lib/matrix"),r=require("./Transform"),o=function(){function o(t){this.children=[],this.points=[],this.rendered=!1,Object.assign(this,t),this.transform=new r.Transform(t),this.updateGlobalTransform()}return o.prototype.initPoints=function(){this.points=[]},o.prototype.setListeners=function(){},o.prototype.removeListeners=function(){},o.prototype._render=function(){this.render()},o.prototype.render=function(){},o.prototype._update=function(t,r){t<0||this.update(t,r)},o.prototype.update=function(t,r){},o.prototype.setParent=function(t){this.parent=t,this.updateGlobalTransform()},o.prototype.addChildren=function(t){Array.isArray(t)||(t=[t]);for(var r=0,o=t;r<o.length;r++){var e=o[r];e.setParent(this),this.children.push(e),this.rendered&&this.game.addObject(e)}},o.prototype.removeChild=function(t){var r=this.children.indexOf(t);r>0&&this.children.splice(r,1)},o.prototype._destroy=function(){this.rendered=!1,this.game.removeObject(this),this.parent&&this.parent.removeChild(this)},o.prototype.destroy=function(){this._destroy()},o.prototype.updateTransformWithProps=function(t){this.transform.updateWithProps(t),this.updateGlobalTransform()},o.prototype.setTransformWithProps=function(t){this.transform.setTransformWithProps(t),this.updateGlobalTransform()},o.prototype.updateGlobalTransform=function(){if(this.globalTransform=new r.Transform,this.globalTransform.updateWithProps(this.transform.getTransformProps()),this.parent){var t=this.parent.globalTransform.getMatrix(),o=this.parent.globalTransform.getTransformProps();this.globalTransform.updateWithProps(o);var e=this.transform.getTransformProps(),s=e.x,n=e.y,i=e.z,a=t[0]*s+t[3]*n+o.x,p=t[1]*s+t[4]*n+o.y;this.globalTransform.setTransformWithProps({x:a,y:p,z:i})}for(var h=0,f=this.children;h<f.length;h++){f[h].updateGlobalTransform()}},o.prototype.normalizePoints=function(t,r){return{x:this.ctx.canvas.width*(t+.5),y:this.ctx.canvas.height*(r+.5)}},o.prototype.localLineTo=function(r,o){var e=t.matrix.transformPoint(this.globalTransform.getMatrix(),r,o),s=this.normalizePoints(e.x,e.y);this.ctx.lineTo(s.x,s.y)},o.prototype.localMoveTo=function(r,o){var e=t.matrix.transformPoint(this.globalTransform.getMatrix(),r,o),s=this.normalizePoints(e.x,e.y);this.ctx.moveTo(s.x,s.y)},o.prototype.setLayer=function(t){this.layer=t},o.prototype.setRenderedState=function(t){this.rendered=t},o}();exports.BaseGameObject=o;
},{"../lib/matrix":"TpxW","./Transform":"BtqO"}],"yxrz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.farDot=exports.square=exports.circle=void 0;var r={};function e(e){if(!r[e]){for(var t=2*Math.PI/e,a=[],s=0;s<e;s++){var o=t*s;a.push({x:.5*Math.cos(o),y:.5*Math.sin(o)})}r[e]=a}return r[e]}exports.circle=e;var t={};function a(r){if(!t[r]){for(var e=[],a=Math.floor(r/4),s=0;s<r;s++)switch(Math.floor(4*s/r)){case 0:e.push({x:.5,y:s/a-.5});break;case 1:e.push({x:.5-(s-a)/a,y:.5});break;case 2:e.push({x:-.5,y:.5-(s-2*a)/a});break;case 3:e.push({x:(s-3*a)/a-.5,y:-.5})}t[r]=e}return t[r]}exports.square=a;var s=.005;function o(r){return e(4).map(function(e){return{x:s*e.x+r.x,y:s*e.y+r.y}})}exports.farDot=o;
},{}],"N6d1":[function(require,module,exports) {
"use strict";function t(t,e,n){var o=e.x-t.x,r=e.y-t.y;return{x:t.x+o*n,y:t.y+r*n}}function e(e,n){for(var o=[],r=0;r<e.length-1;r++)o.push(t(e[r],e[r+1],.5));return n&&o.push(t(e[e.length-1],e[0],.5)),o}function n(t,e,n){var o=Math.cos(n),r=Math.sin(n);return{x:t*o-e*r,y:t*r+e*o}}function o(t,e){var n=Math.atan(e/t);return t<0&&(n+=Math.PI),n}function r(t,e){var n;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];(!n||Date.now()>n+e)&&(t.apply(void 0,o),n=Date.now())}}function i(t,e){var n=null;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];n&&clearTimeout(n),n=setTimeout(function(){t.apply(void 0,o),n=null},e)}}function s(t){return new Promise(function(e){setTimeout(e,t)})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.sleep=exports.debounce=exports.throttle=exports.calcAngle=exports.rotate=exports.calcMidpoints=exports.findPointBetweenPoints=void 0,exports.findPointBetweenPoints=t,exports.calcMidpoints=e,exports.rotate=n,exports.calcAngle=o,exports.throttle=r,exports.debounce=i,exports.sleep=s;
},{}],"m9da":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){function r(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(r.prototype=o.prototype,new r)}}(),e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var e,o=1,r=arguments.length;o<r;o++)for(var i in e=arguments[o])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Bullet=void 0;var o=require("./BaseGameObject"),r=require("../CONSTS"),i=require("../lib/shapes"),n=require("../lib/utils"),s=function(o){function s(t){var e=o.call(this,t)||this;return e.speed=r.BULLET_SPEED,e.color=r.COLORS.PLAYER,e.initPoints(),e}return t(s,o),s.prototype.initPoints=function(){this.points=i.circle(4)},s.prototype.update=function(t){var o=this.transform.getTransformProps().z+t*r.BULLET_SPEED,i=n.findPointBetweenPoints(this.to,this.from,o);this.setTransformWithProps(e({z:o},i))},s.prototype.render=function(){var t=this;this.ctx.fillStyle=this.color,this.ctx.beginPath(),this.points.forEach(function(e,o){var r=e.x,i=e.y;0===o?t.localMoveTo(r,i):t.localLineTo(r,i)}),this.ctx.closePath(),this.ctx.fill()},s}(o.BaseGameObject);exports.Bullet=s;
},{"./BaseGameObject":"f4jx","../CONSTS":"ehtn","../lib/shapes":"yxrz","../lib/utils":"N6d1"}],"o1xW":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,i){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(t,i)};return function(t,i){function n(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),t=this&&this.__assign||function(){return(t=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var o in t=arguments[i])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Player=void 0;var i=require("./BaseGameObject"),n=require("../CONSTS"),o=require("./Bullet"),r=require("../lib/utils"),s=function(i){function s(e){var t=i.call(this,e)||this;return t.color||(t.color=n.COLORS.PLAYER),t.keydown=t.keydown.bind(t),t.keyup=t.keyup.bind(t),t.enableFiring=t.enableFiring.bind(t),t.disableFiring=t.disableFiring.bind(t),t.fireBullet=r.throttle(t._fireBullet.bind(t),150),t}return e(s,i),s.prototype._fireBullet=function(){var e=this.level.getBulletPath(),i=this.level.getPlayerSpotIdx(),n=new o.Bullet(t(t(t({game:this.game,ctx:this.ctx,level:this.level,laneIdx:i,parent:this.parent},e.to),e),{w:.05,h:.05}));this.level.addBullet(n,i),this.game.addObject(n,this.layer)},s.prototype.keydown=function(e){"Space"===e.code&&this.enableFiring()},s.prototype.keyup=function(e){"Space"===e.code&&this.disableFiring()},s.prototype.enableFiring=function(){this.isFiring=!0},s.prototype.disableFiring=function(){this.isFiring=!1},s.prototype.setListeners=function(){window.addEventListener("keydown",this.keydown,!0),window.addEventListener("keyup",this.keyup,!0),this.ctx.canvas.addEventListener("mousedown",this.enableFiring,!0),this.ctx.canvas.addEventListener("mouseup",this.disableFiring,!0)},s.prototype.removeListeners=function(){window.removeEventListener("keydown",this.keydown,!0),window.removeEventListener("keyup",this.keyup,!0),this.ctx.canvas.removeEventListener("mousedown",this.enableFiring,!0),this.ctx.canvas.removeEventListener("mouseup",this.disableFiring,!0)},s.prototype.update=function(){this.isFiring&&this.fireBullet()},s.prototype.render=function(){this.ctx.strokeStyle=this.color,this.ctx.beginPath(),this.localMoveTo(-.25,-.25),this.localLineTo(-.5,0),this.localLineTo(0,.3),this.localLineTo(.5,0),this.localLineTo(.25,-.25),this.localLineTo(.4,0),this.localLineTo(0,.1),this.localLineTo(-.4,0),this.ctx.closePath(),this.ctx.stroke()},s.prototype.setLevel=function(e){this.level=e},s}(i.BaseGameObject);exports.Player=s;
},{"./BaseGameObject":"f4jx","../CONSTS":"ehtn","./Bullet":"m9da","../lib/utils":"N6d1"}],"jKSw":[function(require,module,exports) {
"use strict";var t=this&&this.__assign||function(){return(t=Object.assign||function(t){for(var e,i=1,s=arguments.length;i<s;i++)for(var n in e=arguments[i])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Game=exports.SceneType=void 0;var e,i=require("./objects/Player"),s=require("./lib/utils"),n=require("./CONSTS"),r=function(){function t(){this.layers=[],this.objIdMap={}}return t.prototype.addObject=function(t,e){var i;void 0===e&&(e=0),this.objIdMap[t.id]||(this.layers[e]?this.layers[e][t.id]=t:this.layers[e]=((i={})[t.id]=t,i),this.objIdMap[t.id]=e)},t.prototype.removeObject=function(t){if(void 0!==this.objIdMap[t.id]){var e=this.objIdMap[t.id];delete this.objIdMap[t.id],delete this.layers[e][t.id]}},t.prototype.applyFn=function(t,e){for(var i=0;i<this.layers.length;i++){var s=this.layers[i];Object.values(s).forEach(function(i){e&&!e(i)||t(i)})}},t}();!function(t){t.LEVEL="LEVEL",t.TITLE="TITLE",t.WIN="WIN",t.GAME_OVER="GAME_OVER"}(e=exports.SceneType||(exports.SceneType={}));var a=function(){function a(t){var i=t.canvas,s=t.ctx,n=t.levels,r=t.state,a=void 0===r?{sceneType:e.LEVEL,levelState:{idx:0}}:r;this.running=!0,this.objId=-1,this.canvas=i,this.ctx=s,this.state=a,this.levels=n}return a.prototype.start=function(){this.player=new i.Player(this.getDefaultProps()),this.canvasRect=this.canvas.getBoundingClientRect(),this.startScene(),this.setListeners(),this.lastTime=Date.now(),requestAnimationFrame(this.gameLoop.bind(this))},a.prototype.startScene=function(){switch(this.layerCollection=new r,this.state.sceneType){case e.LEVEL:this.startLevel()}},a.prototype.startLevel=function(){var e=this.state.levelState.idx;this.currLevel=new this.levels[e](t(t({},this.getDefaultProps()),{x:0,y:0,w:.65,h:.65})),this.addObject(this.currLevel,0),this.currLevel.initPlayerSpots(),this.currLevel.setPlayer(this.player),this.currLevel.startSpawning()},a.prototype.addObject=function(t,e){void 0===e&&(e=0),void 0===t.id&&(t.id=this.getNewObjId()),t.setRenderedState(!0),this.layerCollection.addObject(t,e),t.initPoints(),t.setListeners(),t.setLayer(e);for(var i=0,s=t.children;i<s.length;i++){var n=s[i];this.addObject(n,e)}},a.prototype.removeObject=function(t){this.layerCollection.removeObject(t),t.removeListeners();for(var e=0,i=t.children;e<i.length;e++){var s=i[e];this.removeObject(s)}},a.prototype.handleMouse=function(t){this.currLevel&&this.currLevel.startUpdatingWithCursor(t.clientX-this.canvasRect.x,t.clientY-this.canvasRect.y)},a.prototype.handleMouseLeave=function(){this.currLevel&&this.currLevel.stopUpdatingWithCursor()},a.prototype.setListeners=function(){this.canvas.addEventListener("mouseenter",this.handleMouse.bind(this)),this.canvas.addEventListener("mousemove",this.handleMouse.bind(this)),this.canvas.addEventListener("mouseleave",this.handleMouseLeave.bind(this));var t=s.debounce(function(){this.canvasRect=this.canvas.getBoundingClientRect()},200);window.addEventListener("resize",t)},a.prototype.gameLoop=function(t){if(this.running){if(this.lastTime){var e=t-this.lastTime;this.lastTime=t,this.draw(e,t)}else this.lastTime=t;requestAnimationFrame(this.gameLoop.bind(this))}},a.prototype.draw=function(t,e){this.ctx.fillStyle=n.COLORS.BG,this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.layerCollection.applyFn(function(i){i._update(t,e),i._render()})},a.prototype.updateState=function(t){var e=t.sceneType!==this.state.sceneType;this.state=t,e&&this.startScene()},a.prototype.getDefaultProps=function(){return{game:this,ctx:this.ctx,id:this.getNewObjId()}},a.prototype.getNewObjId=function(){return this.objId<n.MAX_ID?this.objId+=1:this.objId=0,this.objId},a}();exports.Game=a;
},{"./objects/Player":"o1xW","./lib/utils":"N6d1","./CONSTS":"ehtn"}],"DmwW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Queue=void 0;var t=function(){function t(t){this.first=null,this.last=null,t&&this.enqueue(t)}return t.prototype.enqueue=function(t){var e=this;Array.isArray(t)||(t=[t]),t.forEach(function(t){var r=new i(t);e.first?(e.last.next=r,e.last=r):e.first=e.last=r})},t.prototype.dequeue=function(){var t=this.first;return this.first===this.last?this.first=this.last=null:this.first=this.first.next,t.item},t.prototype.getFirst=function(){return this.first&&this.first.item},t}();exports.Queue=t;var i=function(){return function(t){this.item=t}}();
},{}],"UaWQ":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(o,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var e in o)Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e])})(o,e)};return function(o,e){function r(){this.constructor=o}t(o,e),o.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.Enemy=void 0;var o=require("./BaseGameObject"),e=require("../CONSTS"),r=require("../lib/shapes"),n=function(o){function n(t){return o.call(this,t)||this}return t(n,o),n.prototype.updatePath=function(t,o){this.to=t,this.from=o},n.prototype.setLevel=function(t){this.level=t},n.prototype.calcFarPoint=function(){var t=.8-.6*Math.min(1,this.transform.z-1);return{x:e.LEVEL_CENTER.x+(this.to.x-e.LEVEL_CENTER.x)*t,y:e.LEVEL_CENTER.y+(this.to.y-e.LEVEL_CENTER.y)*t}},n.prototype.render=function(){var t=this;(this.ctx.strokeStyle=this.color,this.ctx.beginPath(),this.transform.z>1)?r.farDot(this.calcFarPoint()).forEach(function(o,e){var r=o.x,n=o.y;0===e?t.level.localMoveTo(r,n):t.level.localLineTo(r,n)}):this.points.forEach(function(o,e){var r=o.x,n=o.y;0===e?t.localMoveTo(r,n):t.localLineTo(r,n)});this.ctx.closePath(),this.ctx.stroke()},n}(o.BaseGameObject);exports.Enemy=n;
},{"./BaseGameObject":"f4jx","../CONSTS":"ehtn","../lib/shapes":"yxrz"}],"dnHR":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(r,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(t[e]=r[e])})(r,e)};return function(r,e){function o(){this.constructor=r}t(r,e),r.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}(),r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var r,e=1,o=arguments.length;e<o;e++)for(var n in r=arguments[e])Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.RedEnemy=void 0;var e=require("../CONSTS"),o=require("./Enemy"),n=require("../lib/utils"),i=function(o){function i(t){var r=o.call(this,t)||this;return r.color=e.COLORS.RED,r.speed=e.RED_ENEMY_SPEED,r}return t(i,o),i.prototype.initPoints=function(){this.points=[{x:-.5,y:-.25},{x:-.25,y:0},{x:-.5,y:.25},{x:.5,y:-.25},{x:.25,y:0},{x:.5,y:.25}]},i.prototype.update=function(t){var e=this.transform.getTransformProps().z-t*this.speed;if(e<0)this.destroy();else{var o=n.findPointBetweenPoints(this.from,this.to,e);this.setTransformWithProps(r({z:e},o))}},i}(o.Enemy);exports.RedEnemy=i;
},{"../CONSTS":"ehtn","./Enemy":"UaWQ","../lib/utils":"N6d1"}],"LKvn":[function(require,module,exports) {
"use strict";var e=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),t=this&&this.__assign||function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.EnemySpawner=void 0;var n=require("./BaseGameObject"),r=require("./RedEnemy"),o=function(n){function o(e){var t=n.call(this,e)||this;t.startingZ=1.1,t.zIncrement=.1;var r=e.startingZ,o=e.zIncrement;return r&&(t.startingZ=r),o&&(t.zIncrement=o),t}return e(o,n),o.prototype.spawnEnemies=function(){var e=this;this.enemyClasses.forEach(function(n,r){var a=o.enemySizeMap.get(n),i=new n(t(t({},e.game.getDefaultProps()),{w:a,h:a,z:e.startingZ+e.zIncrement*r}));e.level.addEnemy(i)})},o.enemySizeMap=new Map([[r.RedEnemy,.65]]),o}(n.BaseGameObject);exports.EnemySpawner=o;
},{"./BaseGameObject":"f4jx","./RedEnemy":"dnHR"}],"zIeL":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,o){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(e,o)};return function(e,o){function i(){this.constructor=e}t(e,o),e.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}(),e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++)for(var s in e=arguments[o])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Level=void 0;var o=require("./BaseGameObject"),i=require("../lib/utils"),s=require("../CONSTS"),r=require("../lib/Queue"),p=require("./EnemySpawner"),n=function(o){function n(t){var e=o.call(this,t)||this;e.playerSpots=[],e.bulletSpots=[],e.enemyClasses=[],e.enemyStateMap={},e.enemyLaneMap={},e.bulletLaneMap={},e.playerSpotIdx=0,e.targetSpotIdx=0,e.updatingSpot=!1,e.loops=!0,e.farPoints=[],e.midpoints=[],e.farMidpoints=[];var s=t.loops;return void 0!==s&&(e.loops=s),e.throttledUpdateSpot=i.throttle(e.updatePlayerSpot.bind(e),50),e}return t(n,o),n.prototype.startSpawning=function(){this.enemySpawner=new p.EnemySpawner(e(e({},this.game.getDefaultProps()),{level:this,enemyClasses:this.enemyClasses})),this.enemySpawner.spawnEnemies()},n.prototype.setPlayer=function(t){this.player=t,t.updateTransformWithProps(this.playerSpots[this.playerSpotIdx]),this.player.setLevel(this),this.addChildren(t)},n.prototype.addEnemy=function(t){if(!this.enemyStateMap[t.id]){var o=Math.floor(this.farMidpoints.length*Math.random());this.enemyStateMap[t.id]={enemy:t,spotIdx:o},this.enemyLaneMap[o]?this.enemyLaneMap[o].enqueue(t):this.enemyLaneMap[o]=new r.Queue(t),this.addChildren(t);var p=this.farMidpoints[o],n=this.midpoints[o];t.setTransformWithProps(e(e({},p),{w:s.ENEMY_TO_LEVEL_SIZE,h:s.ENEMY_TO_LEVEL_SIZE,angle:Math.PI/2-i.calcAngle(n.x,n.y)})),t.updatePath(p,this.midpoints[o]),t.setLevel(this)}},n.prototype.removeEnemy=function(t){var e=this.enemyStateMap[t.id].spotIdx;delete this.enemyLaneMap[e][t.id],delete this.enemyStateMap[t.id],t.destroy()},n.prototype.addBullet=function(t,e){this.bulletLaneMap[e]?this.bulletLaneMap[e].enqueue(t):this.bulletLaneMap[e]=new r.Queue(t)},n.prototype.moveEnemy=function(t,e){},n.prototype.getLevelPoints=function(){return[]},n.prototype.initPoints=function(){this.points=this.getLevelPoints(),this.farPoints=this.points.map(function(t){var e=t.x,o=t.y,i=s.LEVEL_CENTER.x,r=s.LEVEL_CENTER.y;return{x:i+e*s.FAR_SCALE,y:r+o*s.FAR_SCALE}}),this.midpoints=i.calcMidpoints(this.points,this.loops),this.farMidpoints=i.calcMidpoints(this.farPoints,this.loops)},n.prototype.initPlayerSpots=function(){this.playerSpots=[]},n.prototype.getBulletPath=function(){return{to:this.midpoints[this.playerSpotIdx],from:this.farMidpoints[this.playerSpotIdx]}},n.prototype.getPlayerSpotIdx=function(){return this.playerSpotIdx},n.prototype._render=function(){this.renderLevelPoints(this.points),this.renderLevelPoints(this.farPoints);for(var t=0;t<this.points.length;t++){var e=this.points[t],o=this.farPoints[t],i=this.playerSpotIdx===t||this.playerSpotIdx+1===t||this.loops&&this.playerSpotIdx===this.points.length-1&&0===t?s.COLORS.PLAYER:s.COLORS.LINE;this.ctx.strokeStyle=i,this.ctx.beginPath(),this.localMoveTo(e.x,e.y),this.localLineTo(o.x,o.y),this.ctx.closePath(),this.ctx.stroke()}},n.prototype.renderLevelPoints=function(t){var e=this;this.ctx.beginPath(),this.ctx.strokeStyle=s.COLORS.LINE,t.forEach(function(t,o){var i=t.x,s=t.y;0===o?e.localMoveTo(i,s):e.localLineTo(i,s)}),this.loops&&this.ctx.closePath(),this.ctx.stroke()},n.prototype.update=function(){this.throttledUpdateSpot(),this.checkCollisions(),this.cleanBullets()},n.prototype.checkCollisions=function(){var t=this;Object.keys(this.enemyLaneMap).forEach(function(e){var o=t.enemyLaneMap[e],i=t.bulletLaneMap[e];if(i){var r=o.getFirst(),p=i.getFirst();r&&p&&p.transform.z<1&&p.transform.z+s.BULLET_TOLERANCE>=r.transform.z&&(i.dequeue(),o.dequeue(),t.removeEnemy(r),p.destroy())}})},n.prototype.cleanBullets=function(){var t=this;Object.keys(this.bulletLaneMap).forEach(function(e){for(var o=t.bulletLaneMap[e];o.getFirst()&&o.getFirst().transform.z+s.BULLET_TOLERANCE>1;){o.dequeue().destroy()}})},n.prototype.updatePlayerSpot=function(){if(this.updatingSpot&&this.player&&this.playerSpotIdx!==this.targetSpotIdx&&(this.loops||!(this.targetSpotIdx<0||this.targetSpotIdx>=this.playerSpots.length))){var t=(this.targetSpotIdx<this.playerSpotIdx?this.playerSpots.length+this.targetSpotIdx:this.targetSpotIdx)-this.playerSpotIdx,e=(this.targetSpotIdx>this.playerSpotIdx?this.targetSpotIdx-this.playerSpots.length:this.targetSpotIdx)-this.playerSpotIdx;Math.abs(t)<Math.abs(e)?(this.playerSpotIdx+=1,this.playerSpotIdx>=this.playerSpots.length&&(this.playerSpotIdx=0)):(this.playerSpotIdx-=1,this.playerSpotIdx<0&&(this.playerSpotIdx=this.playerSpots.length-1)),this.player.setTransformWithProps(this.playerSpots[this.playerSpotIdx])}},n.prototype.startUpdatingWithCursor=function(t,e){this.updatingSpot=!0},n.prototype.stopUpdatingWithCursor=function(){this.updatingSpot=!1},n}(o.BaseGameObject);exports.Level=n;
},{"./BaseGameObject":"f4jx","../lib/utils":"N6d1","../CONSTS":"ehtn","../lib/Queue":"DmwW","./EnemySpawner":"LKvn"}],"PLMh":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.Circle=void 0;var e=require("../CONSTS"),r=require("./Level"),n=require("./RedEnemy"),o=require("../lib/shapes"),i=require("../lib/utils"),s=function(r){function s(t){var e=r.call(this,t)||this;return e.rotationSpeed=Math.PI/2e3,e.segments=16,e.enemyClasses=new Array(10).fill(n.RedEnemy),e}return t(s,r),s.prototype.getLevelPoints=function(){return o.circle(this.segments)},s.prototype.initPlayerSpots=function(){for(var t=this.points,r=[],n=0;n<t.length;n++){var o=n===t.length-1?0:n+1,i=t[n],s=t[o],a=(i.x+s.x)/2,p=(i.y+s.y)/2,c=2*Math.PI/this.segments*(.5+n),h=Math.PI/2-c,u=a+e.PLAYER_TO_LEVEL_DIST*Math.cos(c),l=p+e.PLAYER_TO_LEVEL_DIST*Math.sin(c);r.push({x:u,y:l,w:e.PLAYER_TO_LEVEL_SIZE,h:e.PLAYER_TO_LEVEL_SIZE,angle:h})}this.playerSpots=r},s.prototype.startUpdatingWithCursor=function(t,e){this.updatingSpot=!0;var r=t/this.ctx.canvas.width-.5,n=e/this.ctx.canvas.height-.5,o=i.calcAngle(r,n),s=2*Math.PI/this.segments,a=Math.floor(o/s);a<0&&(a+=this.segments),this.targetSpotIdx=a},s.pointsMemo={},s}(r.Level);exports.Circle=s;
},{"../CONSTS":"ehtn","./Level":"zIeL","./RedEnemy":"dnHR","../lib/shapes":"yxrz","../lib/utils":"N6d1"}],"xtb6":[function(require,module,exports) {
"use strict";var t=this&&this.__extends||function(){var t=function(e,r){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(e,r)};return function(e,r){function s(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}();Object.defineProperty(exports,"__esModule",{value:!0}),exports.Square=void 0;var e=require("../CONSTS"),r=require("./Level"),s=require("./RedEnemy"),n=require("../lib/shapes"),o=require("../lib/utils"),i=function(r){function i(t){var e=r.call(this,t)||this;return e.segments=16,e.enemyClasses=new Array(20).fill(s.RedEnemy),e}return t(i,r),i.prototype.getLevelPoints=function(){return n.square(this.segments)},i.prototype.initPlayerSpots=function(){for(var t=this.points,r=[],s=0;s<t.length;s++){var n=s===t.length-1?0:s+1,o=t[s],i=t[n],a=(o.x+i.x)/2,c=(o.y+i.y)/2,h=void 0;switch(Math.floor(4*s/this.segments)){case 0:a+=e.PLAYER_TO_LEVEL_DIST,h=Math.PI/2;break;case 1:c+=e.PLAYER_TO_LEVEL_DIST,h=0;break;case 2:a-=e.PLAYER_TO_LEVEL_DIST,h=-Math.PI/2;break;case 3:c-=e.PLAYER_TO_LEVEL_DIST,h=Math.PI}r.push({x:a,y:c,w:e.PLAYER_TO_LEVEL_SIZE,h:e.PLAYER_TO_LEVEL_SIZE,angle:h})}this.playerSpots=r},i.prototype.startUpdatingWithCursor=function(t,e){this.updatingSpot=!0;var r=t/this.ctx.canvas.width-.5,s=e/this.ctx.canvas.height-.5,n=o.calcAngle(r,s)+Math.PI/4,i=2*Math.PI/this.segments,a=Math.floor(n/i);a<0&&(a+=this.segments),this.targetSpotIdx=a},i.pointsMemo={},i}(r.Level);exports.Square=i;
},{"../CONSTS":"ehtn","./Level":"zIeL","./RedEnemy":"dnHR","../lib/shapes":"yxrz","../lib/utils":"N6d1"}],"ZCfc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t,r,a=require("./Game"),c=require("./objects/Circle"),u=require("./objects/Square");function s(){t=document.getElementById("game"),r=t.getContext("2d"),(e=new a.Game({canvas:t,ctx:r,levels:[c.Circle,u.Square]})).start()}s();
},{"./Game":"jKSw","./objects/Circle":"PLMh","./objects/Square":"xtb6"}]},{},["ZCfc"], null)
//# sourceMappingURL=main.97434ca7.js.map